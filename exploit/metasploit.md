# Metasploit

Exploit -&gt; Payload -&gt; Post Modules

Auxiliary

Modules:

* Exploits
* Payloads
* Auxiliary
* Encoders
* Nops

![](../.gitbook/assets/metasploit-structure.png)


## Initialise the Database

Start postgresql

```ShellSession
service postgresql start
```

Initialize the database

```ShellSession
msfdb init 
```

In msfconsole, rebuild cache

```ShellSession
msf> db_rebuild_cache
```


## Basic Usage

get information on an exploit  
```ShellSession
msf> info [exploit]
```

set options  
```ShellSession
msf> set payload windows/shell/reverse_tcp
```

show options  
```ShellSession
msf> show options
```

run exploit:  

```ShellSession
msf > run` or `msf> exploit
```

run exploit as a job in background:  

```ShellSession
msf> exploit -j
```

list a list of background job:  

```ShellSession
msf> jobs
```

get a list of sessions:  

```ShellSession
msf> sessions -l
```

open a session:  

```ShellSession
msf > sessions -i [N]
``` 
where N is session number

stop an exploit:  
`[CTRL-C]`

go back to msfconsole with terminating the shell:  
`[CTRL-Z]`

kill session:  

```ShellSession
msf> sessions -K
```

exit:  

```ShellSession
msf> exit
```

## Run Metasploit with script

### Creating Resource Script

```ShellSession
msf (ms08_067_netapi) > makerc ~/Desktop/myscript.rc
```

Resource script location

```ShellSession
/path/to/metasploit-framework/scripts/resource
```

### Running Resource Script

```ShellSession
$ ./msfconsole -r <path to resource script>
```

```ShellSession
msf > resource <path to resource script> [param 1] [param 2] [param 3]
```

